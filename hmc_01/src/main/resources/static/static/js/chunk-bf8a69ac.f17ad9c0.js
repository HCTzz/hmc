(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf8a69ac"],{"0538":function(e,t,n){"use strict";var i={inserted:function(e,t){console.log(t.value),t.value.focus===t.value.index&&e.focus()}},r=function(e){e.directive("focus-on-condition",i)};window.Vue&&(window["focus-on-condition"]=i,Vue.use(r)),i.install=r;t["a"]=i},1987:function(e,t,n){"use strict";var i=n("495a"),r=n.n(i);r.a},"28a0":function(e,t){"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},3022:function(e,t,n){(function(e){var i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++)n[t[i]]=Object.getOwnPropertyDescriptor(e,t[i]);return n},r=/%[sdj%]/g;t.format=function(e){if(!j(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(c(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}})),a=i[n];n<o;a=i[++n])v(a)||!I(a)?s+=" "+a:s+=" "+c(a);return s},t.deprecate=function(n,i){if("undefined"!==typeof e&&!0===e.noDeprecation)return n;if("undefined"===typeof e)return function(){return t.deprecate(n,i).apply(this,arguments)};var r=!1;function o(){if(!r){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}return o};var o,s={};function c(e,n){var i={seen:[],stylize:l};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),y(n)?i.showHidden=n:n&&t._extend(i,n),S(i.showHidden)&&(i.showHidden=!1),S(i.depth)&&(i.depth=2),S(i.colors)&&(i.colors=!1),S(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=a),f(i,e,i.depth)}function a(e,t){var n=c.styles[t];return n?"["+c.colors[n][0]+"m"+e+"["+c.colors[n][1]+"m":e}function l(e,t){return e}function u(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}function f(e,n,i){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,e);return j(r)||(r=f(e,r,i)),r}var o=p(e,n);if(o)return o;var s=Object.keys(n),c=u(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),_(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(n);if(0===s.length){if(k(n)){var a=n.name?": "+n.name:"";return e.stylize("[Function"+a+"]","special")}if(E(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(P(n))return e.stylize(Date.prototype.toString.call(n),"date");if(_(n))return d(n)}var l,y="",v=!1,w=["{","}"];if(b(n)&&(v=!0,w=["[","]"]),k(n)){var O=n.name?": "+n.name:"";y=" [Function"+O+"]"}return E(n)&&(y=" "+RegExp.prototype.toString.call(n)),P(n)&&(y=" "+Date.prototype.toUTCString.call(n)),_(n)&&(y=" "+d(n)),0!==s.length||v&&0!=n.length?i<0?E(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=v?h(e,n,i,c,s):s.map((function(t){return g(e,n,i,c,t,v)})),e.seen.pop(),m(l,y,w)):w[0]+y+w[1]}function p(e,t){if(S(t))return e.stylize("undefined","undefined");if(j(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return O(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,i,r){for(var o=[],s=0,c=t.length;s<c;++s)A(t,String(s))?o.push(g(e,t,n,i,String(s),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(g(e,t,n,i,r,!0))})),o}function g(e,t,n,i,r,o){var s,c,a;if(a=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},a.get?c=a.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):a.set&&(c=e.stylize("[Setter]","special")),A(i,r)||(s="["+r+"]"),c||(e.seen.indexOf(a.value)<0?(c=v(n)?f(e,a.value,null):f(e,a.value,n-1),c.indexOf("\n")>-1&&(c=o?c.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+c.split("\n").map((function(e){return"   "+e})).join("\n"))):c=e.stylize("[Circular]","special")),S(s)){if(o&&r.match(/^\d+$/))return c;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+c}function m(e,t,n){var i=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function b(e){return Array.isArray(e)}function y(e){return"boolean"===typeof e}function v(e){return null===e}function w(e){return null==e}function O(e){return"number"===typeof e}function j(e){return"string"===typeof e}function x(e){return"symbol"===typeof e}function S(e){return void 0===e}function E(e){return I(e)&&"[object RegExp]"===C(e)}function I(e){return"object"===typeof e&&null!==e}function P(e){return I(e)&&"[object Date]"===C(e)}function _(e){return I(e)&&("[object Error]"===C(e)||e instanceof Error)}function k(e){return"function"===typeof e}function F(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e}function C(e){return Object.prototype.toString.call(e)}function N(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(S(o)&&(o=Object({NODE_ENV:"production",VUE_APP_BASE_API:"/prod-api",BASE_URL:"/manage/"}).NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var i=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,i,e)}}else s[n]=function(){};return s[n]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=b,t.isBoolean=y,t.isNull=v,t.isNullOrUndefined=w,t.isNumber=O,t.isString=j,t.isSymbol=x,t.isUndefined=S,t.isRegExp=E,t.isObject=I,t.isDate=P,t.isError=_,t.isFunction=k,t.isPrimitive=F,t.isBuffer=n("d60a");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function z(){var e=new Date,t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",z(),t.format.apply(t,arguments))},t.inherits=n("28a0"),t._extend=function(e,t){if(!t||!I(t))return e;var n=Object.keys(t),i=n.length;while(i--)e[n[i]]=t[n[i]];return e};var $="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}function T(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if("function"!==typeof r)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return r.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(D,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,i(t)),n}t.promisify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');if($&&e[$]){var t=e[$];if("function"!==typeof t)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,i=new Promise((function(e,i){t=e,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(e,i){e?n(e):t(i)}));try{e.apply(this,r)}catch(s){n(s)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),$&&Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=$,t.callbackify=T}).call(this,n("4362"))},"3f5e":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var i=n("b775"),r=n("83d6");n("4328");function o(e){return Object(i["a"])({url:"/sysFile/deleteFile",method:"delete",params:{fileKey:e}})}function s(e){window.location.href=r["serverPath"]+"sysFile/downloadFile?fileKey="+e}},"495a":function(e,t,n){},"7a80":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main"},[n("div",{staticClass:"header"},[n("div",[n("el-image",{key:e.getImgSrc(e.photo.fileId),staticClass:"img",attrs:{fit:"cover",src:e.getImgSrc(e.photo.fileId),lazy:""}})],1),e._v(" "),n("div",{staticClass:"info"},[n("span",[e._v(e._s(e.photo.name)+" ("),n("strong",[e._v(e._s(e.photo.imgCount))]),e._v(") ")]),e._v(" "),n("span",[n("editorImage",{staticClass:"editor-upload-btn",attrs:{pickeName:"上传图片",color:"#1890ff",accept:e.accept},on:{successCBK:e.imageSuccessCBK}})],1)])]),e._v(" "),n("div",{staticClass:"content"},[n("el-scrollbar",{staticStyle:{height:"100%"}},[n("el-row",{staticClass:"row"},e._l(e.fileList,(function(t,i){return n("el-col",{key:t.fileId,staticClass:"col",attrs:{xs:12,sm:6,md:4,xl:1}},[n("div",{staticClass:"gutter"},[n("el-image",{directives:[{name:"longtap",rawName:"v-longtap.stop",value:{fn:e.openContext,fileId:t.id,index:i},expression:"{fn:openContext, fileId:file.id, index:index}",modifiers:{stop:!0}}],key:e.getImgSrc(t.fileId),attrs:{"preview-src-list":e.priviewSrcList,fit:"cover",src:e.getImgSrc(t.fileId)},on:{contextmenu:function(n){return n.preventDefault(),n.stopPropagation(),e.contextmenu(t.id,i,n)}}}),e._v(" "),n("div",{staticClass:"descr"},[n("span",{attrs:{contenteditable:"true"},on:{blur:function(n){return e.changeFileName(t,i,n)}}},[e._v(e._s(t.name))]),e._v(" "),n("span",[e._v(e._s(e._f("excludSec")(t.updateTime)))])])],1)])})),1)],1)],1)])},r=[],o=(n("7f7f"),n("ac6a"),n("3022"),n("0538")),s=n("975e"),c=n("3f5e"),a=(n("5c96"),n("cb37"));document.oncontextmenu=function(){return!1};var l={directives:{focusOnCondition:o["a"]},components:{editorImage:a["a"]},data:function(){return{visible:!1,searchFileName:"",fileList:[],priviewSrcList:[],file:null,tempFilelist:[],pid:"",photo:{},fileId:"",defaultImgPath:n("dc3a"),accept:".jpg,.jpeg,.png,.gif,.bmp,.JPG,.JPEG,.PBG,.GIF,.BMP"}},watch:{fileList:function(e,t){this.photo.imgCount=e.length,this.photo["fileId"]=e[0].fileId;var n=this;e.forEach((function(e,t){n.priviewSrcList.push(n.getImgSrc(e.fileId))}))}},mounted:function(){this.pid=this.$route.params.pid,this.freshFileList({pid:this.pid,hasOwer:"y"})},methods:{imageSuccessCBK:function(e){var t=this;e.forEach((function(e){e.hasSuccess&&t.tempFilelist.push({fileId:e.uid,pid:t.pid,name:e.fileName})})),Object(s["b"])(this.tempFilelist).then((function(e){t.$message.success("保存成功"),t.fileList=t.fileList.concat(e.data),t.tempFilelist=[]}))},getImgSrc:function(e){return e?this.$store.state.settings.serverPath+"sysFile/priviewImg?fileKey="+e:this.defaultImgPath},freshFileList:function(e){var t=this,n=this.$loading({lock:!0,text:"加载中",spinner:"el-icon-loading",customClass:"loading",target:".main"});this.fileList=[],Object(s["d"])(e).then((function(e){var n=e.data.list;t.fileList=n,t.photo=e.data.photo})),n.close()},changeFileName:function(e,t,n){var i=this,r=n.target.innerText;e.name!=r&&(e.name=r,Object(s["e"])(e).then((function(e){i.$message.success("修改成功"),i.fileList[t].fileName!==r&&(i.fileList[t].fileName=r)})))},deleteFiles:function(e,t){var n=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){Object(s["c"])({id:e}).then((function(e){n.fileList.splice(t,1),n.$message.success("删除成功！")}))}))},downLoad:function(e,t){Object(c["b"])(this.fileList[t].fileId)},openContext:function(e,t){this.contextmenu(t.fileId,t.index,e)},contextmenu:function(e,t,n){var i=this;return this.$contextmenu({items:[{label:"查看",icon:"el-icon-back",divided:!0,onClick:function(){n.target.click()}},{label:"下载",icon:"el-icon-download",divided:!0,onClick:function(){i.downLoad(e,t)}},{label:"删除",divided:!0,icon:"el-icon-delete",onClick:function(){i.deleteFiles(e,t)}},{label:"重命名",divided:!0,onClick:function(){n.target.parentNode.nextElementSibling.children[0].focus()}}],event:n,zIndex:3,minWidth:100}),!1},searchFile:function(){""==this.searchFileName&&this.tempFilelist.length>0&&this.freshFileList({pid:this.rootId,searchName:this.searchFileName})},back:function(e){if(!this.leftArrowEnable)return!1;this.searchFileName="",this.tempFilelist.length>0&&(this.fileList=this.tempFilelist,this.tempFilelist=[],0==this.currentIndex)?this.leftArrowEnable=!1:(this.currentIndex--,0==this.currentIndex&&(this.leftArrowEnable=!1),this.rightArrowEnable=!0,this.currentPath.splice(this.currentPath.length-2,2))},forward:function(e){if(!this.rightArrowEnable)return!1;this.leftArrowEnable=!0,this.currentIndex++,this.currentIndex+1==this.pathIds.length&&(this.rightArrowEnable=!1)},enterFloder:function(e){if(e.ended)return!1;this.leftArrowEnable=!0,this.pathIds.push(e.fileKey),this.currentIndex++,this.currentPath.push('<a class="path-a" data-id="'+e.fileKey+'">'+e.fileName+"</a>"),this.currentPath.push(this.arrow)},focusDiv:function(e){this.number=e}}},u=l,f=(n("1987"),n("c921"),n("2877")),p=Object(f["a"])(u,i,r,!1,null,"66e09aab",null);t["default"]=p.exports},"8b8d":function(e,t,n){"use strict";var i=n("ff3d"),r=n.n(i);r.a},"975e":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a}));var i=n("b775");n("4328");function r(e){return Object(i["a"])({url:"/photo/photoList",method:"get",params:e})}function o(e){return Object(i["a"])({url:"/photo/addPhoto",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/photo/batchAddPhoto",method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)})}function c(e){return Object(i["a"])({url:"/photo/updatePhoto",method:"post",data:e})}function a(e){return Object(i["a"])({url:"/photo/deletePhoto",method:"post",data:e})}},b8e2:function(e,t,n){"use strict";var i=n("ba6e"),r=n.n(i);r.a},ba6e:function(e,t,n){},c59f:function(e,t,n){},c921:function(e,t,n){"use strict";var i=n("c59f"),r=n.n(i);r.a},cb37:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-container"},[n("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n    "+e._s(e.pickeName)+"\n  ")]),e._v(" "),n("el-dialog",{attrs:{"z-index":"2000",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"with-credentials":!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,action:e.action,"list-type":"picture-card",accept:e.accept,headers:e.header}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("\n        Click upload\n      ")])],1),e._v(" "),n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n      取消\n    ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      保存\n    ")])],1)],1)},r=[],o=(n("ac6a"),n("456d"),n("3f5e")),s=(n("83d6"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"},accept:{type:String,default:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.mp4,.rmvb,.flv"},pickeName:{type:String,required:!1,default:"上传"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],action:this.$store.state.settings.serverPath+"sysFile/fileUpload",header:{token:this.$store.state.user.token}}},methods:{checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every((function(t){return e.listObj[t].hasSuccess}))},handleError:function(e,t){},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map((function(t){return e.listObj[t]}));this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有文件上传. 若出现网络错误, 请刷新页面并重新上传!")},handleSuccess:function(e,t){if(2e4!=e.code)return t.status="fail",t.percentage=0,void this.$message({showClose:!0,message:e.message,type:"error"});for(var n=e.data,i=t.uid,r=Object.keys(this.listObj),o=0,s=r.length;o<s;o++)if(this.listObj[r[o]].uid===i)return this.listObj[r[o]].url=n.filePath,this.listObj[r[o]].hasSuccess=!0,this.listObj[r[o]].uid=n.fileKey,void(this.listObj[r[o]].fileName=n.fileName);t.uid=n.fileKey},handleRemove:function(e){var t=this,n=e.uid,i=this;Object(o["a"])(n).then((function(e){if(2e4!==e.code)i.$message({showClose:!0,message:e.message,type:"error"});else for(var r=Object.keys(t.listObj),o=0,s=r.length;o<s;o++)i.listObj[r[o]].uid===n&&delete i.listObj[r[o]]}))},beforeUpload:function(e){var t=this,n=window.URL||window.webkitURL,i=e.uid;return this.listObj[i]={},new Promise((function(r,o){var s=new Image;s.src=n.createObjectURL(e),s.onload=function(){t.listObj[i]={hasSuccess:!1,uid:e.uid,width:this.width,height:this.height}},r(!0)}))}}}),c=s,a=(n("b8e2"),n("8b8d"),n("2877")),l=Object(a["a"])(c,i,r,!1,null,"712fc388",null);t["a"]=l.exports},d60a:function(e,t){e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},dc3a:function(e,t,n){e.exports=n.p+"static/img/default.33da8803.jpg"},ff3d:function(e,t,n){}}]);