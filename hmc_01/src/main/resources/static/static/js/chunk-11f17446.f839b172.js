(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11f17446"],{"0538":function(e,t,i){"use strict";var n={inserted:function(e,t){console.log(t.value),t.value.focus===t.value.index&&e.focus()}},s=function(e){e.directive("focus-on-condition",n)};window.Vue&&(window["focus-on-condition"]=n,Vue.use(s)),n.install=s;t["a"]=n},"1c64":function(e,t,i){},"1cc6":function(e,t,i){"use strict";var n=i("1c64"),s=i.n(n);s.a},"26c7":function(e,t,i){},"333d":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},s=[];i("c5f6");Math.easeInOutQuad=function(e,t,i,n){return e/=n/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,i){var n=l(),s=e-n,r=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=r;var l=Math.easeInOutQuad(c,n,s,t);o(l),c<t?a(e):i&&"function"===typeof i&&i()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&r(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&r(0,800)}}},u=c,d=(i("1cc6"),i("2877")),h=Object(d["a"])(u,n,s,!1,null,"f3b72548",null);t["a"]=h.exports},"3f5e":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return o}));var n=i("b775"),s=i("83d6");i("4328");function a(e){return Object(n["a"])({url:"/sysFile/deleteFile",method:"delete",params:{fileKey:e}})}function o(e){window.location.href=s["serverPath"]+"sysFile/downloadFile?fileKey="+e}},"3f6bc":function(e,t,i){"use strict";var n=i("58d8"),s=i.n(n);s.a},"58d8":function(e,t,i){},"8b8d":function(e,t,i){"use strict";var n=i("ff3d"),s=i.n(n);s.a},a8ab:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"header"},[i("div",{staticClass:"search"},[i("el-input",{staticClass:"input",staticStyle:{width:"auto"},attrs:{size:"mini",type:"text",placeholder:"搜索视频",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchFile(t)}},model:{value:e.listQuery.searchFileName,callback:function(t){e.$set(e.listQuery,"searchFileName",t)},expression:"listQuery.searchFileName"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchFile},slot:"append"})],1),e._v(" "),i("editorImage",{staticClass:"editor-upload-btn",staticStyle:{display:"inline-block"},attrs:{pickeName:"上传视频",color:"#1890ff",accept:e.accept},on:{successCBK:e.imageSuccessCBK}})],1)]),e._v(" "),i("div",{staticClass:"content"},[i("el-scrollbar",{staticStyle:{height:"100%"}},[i("el-row",{staticClass:"row"},e._l(e.fileList,(function(t,n){return i("el-col",{key:t.fileKey,staticClass:"col",attrs:{xs:12,sm:6,md:4,xl:1}},[i("div",{directives:[{name:"longtap",rawName:"v-longtap.stop",value:{fn:e.openContext,fileId:t.fileKey,index:n},expression:"{fn:openContext, fileId:video.fileKey, index:index}",modifiers:{stop:!0}}],staticClass:"gutter",on:{"!contextmenu":function(i){return i.preventDefault(),i.stopPropagation(),e.contextmenu(t.fileKey,n,i)}}},[i("div",{staticClass:"img-div",on:{click:function(i){return e.priviewVideo(t)}}},[i("el-image",{staticClass:"el-image",attrs:{fit:"cover",src:e.getImgSrc(t.fileKey)}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("img",{staticStyle:{"background-size":"cover","max-width":"100%"},attrs:{src:e.getImgSrc(""),alt:""}})])]),e._v(" "),i("span",[e._v(e._s(e._f("dateParse")(t.createTime)))]),e._v(" "),i("span",[e._v(e._s(e._f("renderSize")(t.fileSize)))]),e._v(" "),i("i",{staticClass:"el-icon-video-play"})],1),e._v(" "),i("div",{staticClass:"descr"},[i("span",{attrs:{contenteditable:"true"},on:{blur:function(i){return e.changeFileName(t,n,i)}}},[e._v(e._s(t.fileName))]),e._v(" "),i("span",[e._v(e._s(e._f("resloveVideoDuration")(t.fileDuration)))])])])])})),1)],1)],1),e._v(" "),i("div",{staticClass:"pagination"},[i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.changePage}})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.playEleShow,expression:"playEleShow"}],staticClass:"videoDialog"},[i("video",{ref:"videoElement",staticClass:"centeredVideo",style:{height:e.height},attrs:{controls:""}},[e._v("\n          Your browser is too old which doesn't support HTML5 video.\n      ")]),e._v(" "),i("i",{staticClass:"el-icon-circle-close",on:{click:e.destoryFlv}})])])},s=[],a=i("333d"),o=i("0538"),l=i("b775");i("83d6"),i("4328");function r(e){return Object(l["a"])({url:"/video/list",method:"get",params:e})}function c(e){return Object(l["a"])({url:"/video/updateVideo",method:"post",data:e})}var u=i("3f5e"),d=(i("5c96"),i("cb37")),h=i("fc78"),f=i.n(h);document.oncontextmenu=function(){return!1};var p={directives:{focusOnCondition:o["a"]},components:{editorImage:d["a"],Pagination:a["a"]},data:function(){return{visible:!1,fileList:[],total:0,pages:0,playEleShow:!1,width:0,height:0,listQuery:{page:1,limit:10,searchFileName:""},player:null,fileId:"",tempFilelist:[],defaultImgPath:i("dc3a"),accept:".MP4,.mp4,.flv,.FLV"}},watch:{},mounted:function(){this.freshFileList(this.listQuery)},methods:{priviewVideo:function(e){this.player&&this.destoryFlv(),this.height=e.fileHeight+"px",this.width=e.fileWidth+"px",this.playEleShow=!0,this.player=f.a.createPlayer({type:e.fileExt,isLive:!1,duration:e.fileDuration,filesize:e.fileSize,url:this.$store.state.settings.serverPath+"video/priviewVideo?fileKey="+e.fileKey},{stashInitialSize:"1024KB"}),this.player.attachMediaElement(this.$refs.videoElement),this.player.load(),this.player.play(),this.player.on(f.a.Events.ERROR,(function(e,t,i){console.log("errorType:",e),console.log("errorDetail:",t),console.log("errorInfo:",i)}));var t=this;this.$refs.videoElement.addEventListener("error",(function(e){t.$message({type:"error",message:"视频加载失败"})}))},destoryFlv:function(){this.playEleShow=!1,this.player.destroy(),this.player=null},changePage:function(e){this.listQuery=e,this.freshFileList(e)},imageSuccessCBK:function(e){freshFileList()},getImgSrc:function(e){return e?this.$store.state.settings.serverPath+"sysFile/priviewImg?fileKey="+e:this.defaultImgPath},freshFileList:function(e){var t=this,i=this.$loading({lock:!0,text:"加载中",spinner:"el-icon-loading",customClass:"loading",target:".main"});this.fileList=[],r(e).then((function(e){var i=e.data.data;t.fileList=i,t.total=e.data.count,t.pages=e.data.pages})),i.close()},changeFileName:function(e,t,i){var n=this,s=i.target.innerText;e.fileName!=s&&(e.fileName=s,c(e).then((function(e){n.$message.success("修改成功"),n.fileList[t].fileName!==s&&(n.fileList[t].fileName=s)})))},deleteFiles:function(e,t){var i=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){Object(u["a"])(e).then((function(e){i.fileList.splice(t,1),i.$message.success("删除成功！")}))}))},downLoad:function(e,t){Object(u["b"])(e)},openContext:function(e,t){this.contextmenu(t.fileId,t.index,e)},contextmenu:function(e,t,i){var n=this;return this.$contextmenu({items:[{label:"查看",icon:"el-icon-back",divided:!0,onClick:function(){i.target.click()}},{label:"下载",icon:"el-icon-download",divided:!0,onClick:function(){n.downLoad(e,t)}},{label:"删除",divided:!0,icon:"el-icon-delete",onClick:function(){n.deleteFiles(e,t)}}],event:i,zIndex:3,minWidth:100}),!1},searchFile:function(){""==this.listQuery.searchFileName&&this.tempFilelist.length>0&&this.freshFileList({searchName:this.listQuery.searchFileName})},back:function(e){if(!this.leftArrowEnable)return!1;this.listQuery.searchFileName="",this.tempFilelist.length>0&&(this.fileList=this.tempFilelist,this.tempFilelist=[],0==this.currentIndex)?this.leftArrowEnable=!1:(this.currentIndex--,0==this.currentIndex&&(this.leftArrowEnable=!1),this.rightArrowEnable=!0,this.currentPath.splice(this.currentPath.length-2,2))},forward:function(e){if(!this.rightArrowEnable)return!1;this.leftArrowEnable=!0,this.currentIndex++,this.currentIndex+1==this.pathIds.length&&(this.rightArrowEnable=!1)},enterFloder:function(e){if(e.ended)return!1;this.leftArrowEnable=!0,this.pathIds.push(e.fileKey),this.currentIndex++,this.currentPath.push('<a class="path-a" data-id="'+e.fileKey+'">'+e.fileName+"</a>"),this.currentPath.push(this.arrow)},focusDiv:function(e){this.number=e}}},m=p,g=(i("3f6bc"),i("cb94"),i("2877")),v=Object(g["a"])(m,n,s,!1,null,"666107d2",null);t["default"]=v.exports},b8e2:function(e,t,i){"use strict";var n=i("ba6e"),s=i.n(n);s.a},ba6e:function(e,t,i){},cb37:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n    "+e._s(e.pickeName)+"\n  ")]),e._v(" "),i("el-dialog",{attrs:{"z-index":"2000",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"with-credentials":!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,action:e.action,"list-type":"picture-card",accept:e.accept,headers:e.header}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("\n        Click upload\n      ")])],1),e._v(" "),i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n      取消\n    ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      保存\n    ")])],1)],1)},s=[],a=(i("ac6a"),i("456d"),i("3f5e")),o=(i("83d6"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"},accept:{type:String,default:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.mp4,.rmvb,.flv"},pickeName:{type:String,required:!1,default:"上传"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],action:this.$store.state.settings.serverPath+"sysFile/fileUpload",header:{token:this.$store.state.user.token}}},methods:{checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every((function(t){return e.listObj[t].hasSuccess}))},handleError:function(e,t){},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map((function(t){return e.listObj[t]}));this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有文件上传. 若出现网络错误, 请刷新页面并重新上传!")},handleSuccess:function(e,t){if(2e4!=e.code)return t.status="fail",t.percentage=0,void this.$message({showClose:!0,message:e.message,type:"error"});for(var i=e.data,n=t.uid,s=Object.keys(this.listObj),a=0,o=s.length;a<o;a++)if(this.listObj[s[a]].uid===n)return this.listObj[s[a]].url=i.filePath,this.listObj[s[a]].hasSuccess=!0,this.listObj[s[a]].uid=i.fileKey,void(this.listObj[s[a]].fileName=i.fileName);t.uid=i.fileKey},handleRemove:function(e){var t=this,i=e.uid,n=this;Object(a["a"])(i).then((function(e){if(2e4!==e.code)n.$message({showClose:!0,message:e.message,type:"error"});else for(var s=Object.keys(t.listObj),a=0,o=s.length;a<o;a++)n.listObj[s[a]].uid===i&&delete n.listObj[s[a]]}))},beforeUpload:function(e){var t=this,i=window.URL||window.webkitURL,n=e.uid;return this.listObj[n]={},new Promise((function(s,a){var o=new Image;o.src=i.createObjectURL(e),o.onload=function(){t.listObj[n]={hasSuccess:!1,uid:e.uid,width:this.width,height:this.height}},s(!0)}))}}}),l=o,r=(i("b8e2"),i("8b8d"),i("2877")),c=Object(r["a"])(l,n,s,!1,null,"712fc388",null);t["a"]=c.exports},cb94:function(e,t,i){"use strict";var n=i("26c7"),s=i.n(n);s.a},dc3a:function(e,t,i){e.exports=i.p+"static/img/default.33da8803.jpg"},ff3d:function(e,t,i){}}]);